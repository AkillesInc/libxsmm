#!/bin/bash
if [ "x$MPI_LOCALRANKID" == "x" ] ; then
  NUMANODE=0
else
  NUMANODE=$MPI_LOCALRANKID
fi

numactl -m $NUMANODE python -u dlrm_s_pytorch.py --mini-batch-size=16384 --test-mini-batch-size=16384 --test-num-workers=0 --num-batches=20 --data-generation=random --arch-mlp-bot=2048-2048-2048-2048-2048-2048-2048-2048-128 --arch-mlp-top=4096-4096-4096-4096-4096-4096-4096-4096-4096-4096-4096-4096-4096-4096-4096-1 --arch-sparse-feature-size=128 --arch-embedding-size=4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000-4000000 --num-indices-per-lookup=200 --arch-interaction-op=dot --numpy-rand-seed=727 --print-freq=2 --print-time $@
# --enable-profiling


